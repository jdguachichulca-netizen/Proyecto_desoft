<ion-content>
  <div class="stars-bg"></div>

  <div class="header-section">
    <h1>NIVEL 10: IDENTIDAD FRAGMENTADA</h1>
  </div>

  <div class="game-layout">
    
    <div class="panel left-panel">
      <div class="panel-header">XENO-TRADUCTOR</div>
      <div class="panel-body">
        
        <div class="robot-scene">
          <img src="assets/robotfragmentado.png" alt="W-BIT Fragmentado" onerror="this.src='assets/wbit_js_contact.png'">
        </div>
        
        <div class="story-box">
          <p>
            <strong style="color: #e94560;">¡ERROR CRÍTICO!</strong> 
            Los datos de identidad están separados.
            Debes <strong style="color: #00fff5;">concatenar (+)</strong> las variables para formar la frase de reinicio.
          </p>
        </div>

        <div class="syntax-card">
          <h4>MANUAL: CONCATENACIÓN (+)</h4>
          
          <div class="comparison-row">
            <div class="col">
              <small>EJEMPLO BÁSICO</small>
              <code class="new">"Hola " <span style="color:#e94560">+</span> "Mundo"</code>
              <small style="color: #666; margin-top: 5px;">Resultado: "Hola Mundo"</small>
            </div>
          </div>

          <div class="comparison-row">
            <div class="col">
              <small>VARIABLE + TEXTO</small>
              <code>nombre + " está listo"</code>
            </div>
          </div>
        </div>

        <div class="mission-guide">
          <h4>OBJETIVO DE MISIÓN</h4>
          <p style="font-size: 0.9rem; margin-bottom: 10px;">Debes formar la frase exacta:</p>
          <div style="background: #222; color: #00ff88; padding: 5px; margin-bottom: 10px; font-family: monospace; text-align: center;">
            "W-BIT v2 está Operativo"
          </div>
          <ol>
            <li>Crea: <code>let modelo = "W-BIT v2";</code></li>
            <li>Crea: <code>let estado = "Operativo";</code></li>
            <li>Une todo con <code>console.log</code> (¡Cuidado con los espacios!)</li>
          </ol>
        </div>

      </div>
    </div>

    <div class="panel center-panel">
      <div class="panel-header">TERMINAL DE COMANDO (JS)</div>
      
      <div class="editor-container">
        <div class="line-numbers">1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10</div>
        
        <textarea 
          class="code-input" 
          [(ngModel)]="codigoUsuario" 
          spellcheck="false" 
          placeholder="// 1. Crea las variables...&#10;let modelo = ...&#10;&#10;// 2. Une con + ...&#10;console.log(modelo + ...)">
        </textarea>
      </div>

      <button class="btn-compile" (click)="ejecutarCodigo()" [disabled]="nivelCompletado">
        EJECUTAR SECUENCIA DE UNIÓN
      </button>
    </div>

    <div class="panel right-panel">
      <div class="panel-header">ESTADO DE SEÑAL</div>
      <div class="panel-body centered-body">
        
        <div class="satellite-container" [class.active]="nivelCompletado">
          <div class="dish"></div>
        </div>

        <div class="screen-output">
          <small>SEÑAL DE SALIDA:</small>
          <div class="text-signal" style="white-space: pre-wrap;">
            {{ mensajeSalida || 'ESPERANDO DATOS...' }}
          </div>
        </div>

        <div class="system-logs">
          <div *ngFor="let log of consolaLogs" [class]="log.tipo">
            > {{ log.mensaje }}
          </div>
        </div>

        <button *ngIf="nivelCompletado" class="btn-next" (click)="guardarProgreso()">
          MISIÓN CUMPLIDA (+250 XP)
        </button>

      </div>
    </div>

  </div>
</ion-content>